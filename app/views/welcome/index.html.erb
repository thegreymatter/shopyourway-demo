  <div id="container">
    <div id="header">
      <div class="headerbox">
        <img src="//hapyak_demos.s3.amazonaws.com/demos/shopyourway/Screen%20Shot%202014-12-30%20at%203.17.19%20PM.png">
      </div>
      <div class="headerbox">
        <div id="cart">
          <img src="//hapyak_demos.s3.amazonaws.com/demos/shopyourway/Screen%20Shot%202014-12-30%20at%203.20.18%20PM.png">
        </div>
        </div>
    </div>

  </div>
  <div id="background">
    <div id="heading">
      <!-- declared via greeting function  -->
      Want to see what Santa has for you?
    </div>
    <div class="body-container">
      <div id="menu">
        Enhanced by Hapyak
        <ul>
          <li>Dynamically generate targeted video campagins</li>
          <li>Indepth analytic reports help assist your team in analyzing the effectiveness of your video strategy</li>
        </ul>
      </div>
    </div>
    <div class="body-container">
      <div id="video-container">
        <div class="video">

          <script type="text/javascript" src="//d2qrdklrsxowl2.cloudfront.net/js/hapyak.js"></script>
            <div style="width:720px;overflow:hidden;height:405px;position:relative;">
               <div id="hapyak-player-12702-542"></div>
            </div>
            <div id="welcome">
              <!-- Welcome message will appear when user engters email address -->
            </div>
            <div id="picture-container">
              <% @products.shuffle.take(8).each do |product| %>
                <div class="product-image">
                  <img src="<%= product['imageUrl']%>" height='75'>
                </div>
              <% end %>
            </div>
        </div>
      </div>
    </div>
  </div>



<script>
  function updateCart(){
    $('#cart').fadeIn('slow');
  }
  function welcome(email_address){
    $('#welcome').text("Great! You can find your catalogs waiting under, " + email_address + ".");
      console.log('is this working???');
      console.log(js_products);
  }
  function greeting(name){
    if( !user_name ){
      $('#heading').text('Want to see what Santa has for you, ' + name + '?');
    }
  }


window.onYouTubeIframeAPIReady = function() {
   var ytPlayer = new YT.Player("hapyak-player-12702-542", {
       height: "405",
       width: "720",
       videoId: "M6TvaQ26QGw",
       playerVars: {
           controls: /(iPhone|iPad)/i.test(navigator.userAgent) ? 0 : 2,
           html: 1,
           playsinline: 1,
           autohide: 1,
           modestbranding: 1,
           rel: 0,
           fs: 0,
           showinfo: 0,
           wmode: "opaque"
       }
   });
   hapyak.viewer({
       apiKey: "9ce017788cae460fa172",
       projectId: 12702,
       resetVariables: true,
       player: ytPlayer,
       playerType: "youtube",
       width: 720,
       height: 405,
       autoplay: false,
      onload: function(viewer) {
          viewer.addEventListener('data', function (variables) {
              if (variables && (variables.cart_count > 0)) {
                updateCart();
              }
              if (variables && variables.submit_value) {
               welcome(variables.submit_value);
              }
              if (variables && variables.user_name) {
               greeting(variables.user_name);
              }
          });
    }
   });
};

  </script>
<script src="//www.youtube.com/iframe_api"></script>


<div id="json-hash">
 [ <% @products.each do |product| %>
    '<%= product['imageUrl'] %>',
  <% end %>]
</div>


